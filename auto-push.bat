@echo off
chcp 65001 >nul 2>&1  :: è®¾ç½®ç¼–ç ä¸ºUTF-8ï¼Œç¡®ä¿ä¸­æ–‡æ­£å¸¸æ˜¾ç¤º

echo ==============================================
echo            Gitè‡ªåŠ¨ä¸Šä¼ åˆ°GitHubå·¥å…·
echo ==============================================
echo.

:: æ£€æŸ¥æ˜¯å¦åœ¨Gitä»“åº“ä¸­
if not exist .git (
    echo âŒ é”™è¯¯ï¼šå½“å‰æ–‡ä»¶å¤¹ä¸æ˜¯Gitä»“åº“
    echo    è¯·åœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­è¿è¡Œæ­¤è„šæœ¬ï¼Œæˆ–å…ˆæ‰§è¡Œ git init åˆå§‹åŒ–ä»“åº“
    pause
    exit /b 1
)

:: æ£€æŸ¥è¿œç¨‹ä»“åº“é…ç½®
git remote >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ é”™è¯¯ï¼šæœªé…ç½®è¿œç¨‹ä»“åº“
    echo    è¯·å…ˆæ‰§è¡Œ git remote add origin [ä»“åº“åœ°å€] å…³è”è¿œç¨‹ä»“åº“
    pause
    exit /b 1
)

:: è·Ÿè¸ªæ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
echo ðŸ” æ­£åœ¨æ£€æµ‹æ–‡ä»¶ä¿®æ”¹...
git add .
echo âœ… æ–‡ä»¶è·Ÿè¸ªå®Œæˆï¼ˆå·²å°†æ‰€æœ‰ä¿®æ”¹åŠ å…¥æš‚å­˜åŒºï¼‰
echo.

:: æäº¤ä¿®æ”¹ï¼ˆå¸¦è¯¦ç»†æ—¶é—´ï¼‰
echo ðŸ“ æ­£åœ¨åˆ›å»ºæäº¤è®°å½•...
for /f "tokens=1-3 delims=/: " %%a in ("%time%") do (
    set "formatted_time=%%aæ—¶%%båˆ†%%cç§’"
)
git commit -m "è‡ªåŠ¨æäº¤ï¼š%date% %formatted_time% - è‡ªåŠ¨åŒæ­¥æœ¬åœ°ä¿®æ”¹"

:: æ£€æŸ¥æäº¤æ˜¯å¦æˆåŠŸ
if %errorlevel% equ 0 (
    echo âœ… æäº¤æˆåŠŸï¼ˆæäº¤ä¿¡æ¯ï¼šè‡ªåŠ¨æäº¤ï¼š%date% %formatted_time%ï¼‰
    echo.
    
    :: æŽ¨é€åˆ°è¿œç¨‹ä»“åº“
    echo ðŸš€ æ­£åœ¨æŽ¨é€åˆ°GitHubè¿œç¨‹ä»“åº“...
    git push
    
    :: æ£€æŸ¥æŽ¨é€æ˜¯å¦æˆåŠŸ
    if %errorlevel% equ 0 (
        echo âœ… æŽ¨é€å®Œæˆï¼æœ¬åœ°ä¿®æ”¹å·²åŒæ­¥åˆ°è¿œç¨‹ä»“åº“
    ) else (
        echo âŒ æŽ¨é€å¤±è´¥ï¼å¯èƒ½åŽŸå› ï¼š
        echo    1. ç½‘ç»œè¿žæŽ¥é—®é¢˜
        echo    2. è¿œç¨‹ä»“åº“æƒé™ä¸è¶³
        echo    3. éœ€è¦å…ˆæ‰§è¡Œ git pull åŒæ­¥è¿œç¨‹ä¿®æ”¹
    )
) else (
    echo âš ï¸ æ²¡æœ‰éœ€è¦æäº¤çš„ä¿®æ”¹ï¼ˆæ‰€æœ‰æ–‡ä»¶å·²ä¸Žä¸Šæ¬¡æäº¤ä¸€è‡´ï¼‰
)

echo.
echo ==============================================
echo æ“ä½œç»“æŸï¼ŒæŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause >nul
